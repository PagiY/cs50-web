{% extends "network/layout.html" %}
{% load static %}

{% block body %}
    <h2>{{profile_user.username}}</h2>
    <div>
        <p>Followers {{follower_count}}</p>
        <p>Following {{following_count}}</p>

        {% if profile_user != user %}

            <form action = "{% url 'profile' profile_user.id %}" method = "post">
                {%csrf_token%} 
                {%if following%}
                    <button type = "submit" id = "follow-btn" class = "btn btn-primary"> Unfollow </button>
                {%else%}
                    <button type = "submit" id = "follow-btn" class = "btn btn-primary"> Follow </button>
                {%endif%}
            </form>

        {% endif %}

    </div>

    <div class = "post-container">
        {% for post in all_posts %}
            
            <div class = "card">
                
                <div id = '{{post.id}}' class = "card-body">

                    <a href = "{% url 'profile' post.user.id %}"><p class="card-title"><b>{{post.user}}</b></p></a>
                    
                    <div class = "post-content">
                        <small class="card-subtitle mb-2 text-muted">{{post.timestamp}}</small>
                        <p class="card-text">{{post.text}}</p>
                    </div>

                    {% if user.is_authenticated %}
                    <div class = "post-buttons pt-2">
                        {% if user in post.user_likes.all%}
                            <button id = "like-post" class="card-link btn btn-primary">Unlike <span id = "like-counts" class="badge text-bg-secondary">{{post.user_likes.all.count}}</span></button>
                        {%else%}
                            <button id = "like-post" class="card-link btn btn-primary">Like <span id   = "like-counts" class="badge text-bg-secondary">{{post.user_likes.all.count}}</span></button>
                        {%endif%}

                        {% if post.user == user%}
                            <button id = "edit-post" class="card-link btn btn-primary">Edit Post</button>
                        {%endif%}   
                    </div>
                    {%endif%}

                </div>

            </div>

        {% endfor %}
    </div>

{% endblock %}

{%block script%}
    <script src = "{% static 'network/scripts.js' %}"></script>
{%endblock%}
